# 中医药膳 AI 推荐系统

## 接口文档（API 文档）

### 1. 概述

本接口文档基于 **RESTful 风格**，接口返回统一格式：

```json
{
  "code": 1,       // 1=成功, 其他=错误码
  "msg": "success", // 提示信息
  "data": {...}     // 返回数据（对象/数组）
}
```

------

### 2. 用户模块

#### 2.1 用户注册 / 绑定手机号

- **URL**：`POST /user/register`

- **参数**：

	```json
	{
	  "phone": "13800000000",
	  "password": "123456",
	  "nickname": "小明"
	}
	```

- **返回**：

	```json
	{
	  "code": 1,
	  "msg": "success",
	  "data": { "userId": 1 }
	}
	```

------

#### 2.2 微信登录

- **URL**：`POST /auth/wechat`

- **参数**：

	```json
	{
	  "code": "wx临时登录凭证code"
	}
	```

- **说明**：前端小程序调用 `wx.login()` 获取 `code`，后端换取 `openid`。

- **返回**：

	```json
	{
	  "code": 1,
	  "msg": "success",
	  "data": { "userId": 1, "token": "jwt-token" }
	}
	```

------

#### 2.3 用户信息查询

- **URL**：`GET /user/{userId}`

- **返回**：

	```json
	{
	  "code": 1,
	  "data": {
	    "userId": 1,
	    "nickname": "小明",
	    "avatarUrl": "http://xxx.com/1.png",
	    "phone": "13800000000",
	    "status": 1
	  }
	}
	```

------

### 3. 健康画像模块

#### 3.1 提交健康画像

- **URL**：`POST /health/profile`

- **参数**：

	```json
	{
	  "userId": 1,
	  "age": 20,
	  "gender": 1,
	  "bloodPressure": 1,
	  "bloodSugar": 0,
	  "symptoms": ["疲劳", "失眠"],
	  "diseases": ["高血压"]
	}
	```

- **返回**：

	```json
	{
	  "code": 1,
	  "msg": "success",
	  "data": { "profileId": 101 }
	}
	```

------

#### 3.2 查看用户的健康画像历史

- **URL**：`GET /health/profile/list?userId=1`

- **返回**：

	```json
	{
	  "code": 1,
	  "data": [
	    {
	      "profileId": 101,
	      "age": 20,
	      "gender": 1,
	      "bloodPressure": 1,
	      "bloodSugar": 0,
	      "symptoms": ["疲劳", "失眠"],
	      "diseases": ["高血压"],
	      "createdTime": "2025-09-04 20:30:00"
	    }
	  ]
	}
	```

------

### 4. 药膳/奶茶知识库模块

#### 4.1 查询所有药膳

- **URL**：`GET /recipe/list?type=0`

- **说明**：`type=0` 药膳，`type=1` 奶茶。

- **返回**：

	```json
	{
	  "code": 1,
	  "data": [
	    {
	      "id": 1,
	      "name": "山药粥",
	      "intro": "补脾益气",
	      "taboo": "糖尿病人慎用",
	      "effect": "主治消化不良",
	      "suitableTime": "饭前",
	      "method": "将山药煮粥..."
	    }
	  ]
	}
	```

------

#### 4.2 根据功能/标签筛选奶茶

- **URL**：`GET /recipe/list?type=1&tag=祛湿`

- **返回**：

	```json
	{
	  "code": 1,
	  "data": [
	    {
	      "id": 5,
	      "name": "红豆薏米奶茶",
	      "intro": "健脾祛湿",
	      "effect": "祛湿",
	      "tags": ["祛湿", "养生"]
	    }
	  ]
	}
	```

------

### 5. 推荐模块

#### 5.1 生成推荐（AI 推荐接口）

- **URL**：`POST /recommend/generate`

- **参数**：

	```json
	{
	  "userId": 1,
	  "profileId": 101
	}
	```

- **说明**：根据 `health_profile` 生成推荐结果，并保存到 `recommendation` 表。

- **返回**：

	```json
	{
	  "code": 1,
	  "msg": "success",
	  "data": [
	    { "recipeId": 1, "name": "山药粥" },
	    { "recipeId": 5, "name": "红豆薏米奶茶" }
	  ]
	}
	```

------

#### 5.2 查看历史推荐

- **URL**：`GET /recommend/list?userId=1`

- **返回**：

	```json
	{
	  "code": 1,
	  "data": [
	    {
	      "recId": 1,
	      "profileId": 101,
	      "recipeId": 1,
	      "recipeName": "山药粥",
	      "recommendTime": "2025-09-04 20:35:00"
	    }
	  ]
	}
	```

------

### 6. 内容模块

#### 6.1 内容列表

- **URL**：`GET /content/list`

- **返回**：

	```json
	{
	  "code": 1,
	  "data": [
	    {
	      "contentId": 1,
	      "title": "夏季养生茶推荐",
	      "contentType": "article",
	      "imageUrl": "http://xxx.com/tea.png"
	    }
	  ]
	}
	```

------

#### 6.2 收藏内容

- **URL**：`POST /content/favorite`

- **参数**：

	```json
	{
	  "userId": 1,
	  "contentId": 1
	}
	```

- **返回**：

	```json
	{ "code": 1, "msg": "收藏成功" }
	```

------

## 7. 权限说明

- **需要登录** 的接口需带上 `Authorization: Bearer `
- 用户只能访问自己的健康画像和推荐记录。

